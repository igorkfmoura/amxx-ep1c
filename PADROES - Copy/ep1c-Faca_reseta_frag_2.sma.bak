#include <amxmodx>
#include <cstrike>
#include <fun>

#define PLUGIN  "ep1c: Faca reseta frag"
#define VERSION "1.1"
#define AUTHOR  "Wilian M."


public plugin_init()
{
	register_plugin(PLUGIN, VERSION, AUTHOR)

	register_event("DeathMsg", "xDeathMsg", "a")

}

public xDeathMsg()
{
	new xKiller = read_data(1)
	new xVictim = read_data(2)

	if(xKiller == xVictim)
		return

	new xWpn[32]
	read_data(4, xWpn, charsmax(xWpn))
    
	if(equal(xWpn, "knife") && is_user_alive(xKiller))
    {
		static xNameVic[20], xNameKiller[20]
		get_user_name(xKiller, xNameKiller, charsmax(xNameKiller))
		get_user_name(xVictim, xNameVic, charsmax(xNameVic))

		client_print_color(0, print_team_default, "^4>> ^3%s ^1teve seu ^4FRAG ^1resetado pois morreu na faca por: ^3%s^1!", xNameVic, xNameKiller)

		set_task(1.0, "xResetScore", xVictim+22417)
    }
}

public xResetScore(xVictim)
{
	xVictim -= 22417

	if(!is_user_connected(xVictim))
	{
		remove_task(xVictim+22417)
		return
	}

	cs_set_user_deaths(xVictim, 0)
	set_user_frags(xVictim, 0)
	cs_set_user_deaths(xVictim, 0)
	set_user_frags(xVictim, 0)
}
